<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <style>
    body {
      margin: 0;
      padding: 0;
    }
  </style>
</head>

<body>
  <div id="chart"></div>
  <script src="scripts/echarts.min.js"></script>
  <script src="scripts/map/js/china.js"></script>
  <script src="scripts/axios.min.js"></script>
  <script>
    let divEle = document.getElementById('chart');
    //动态设置图表容器的宽度和高度
    divEle.style.width = window.innerWidth + 'px';
    divEle.style.height = window.innerHeight + 'px';
    //创建图表实例
    let chart = echarts.init(divEle, '', {
      renderer: 'canvas'
    });
    //调用图表实例的setOption()方法以完成图表的配置
    chart.setOption({
      //标题组件
      title: {
        //主标题内容
        text: '全国(含港澳台)疫情分布图',
        //主标题的链接
        link: 'http://www.jd.com',
        //打开主标题链接的窗口形式(没有下划线)
        target: 'blank',
        //主标题的文本样式
        textStyle: {
          color: '#0aa1ed',
          fontSize: 24
        },
        //副标题文本
        subtext: '截止到2020-06-19 00:00:00',
        //副标题文本样式
        subtextStyle: {
          fontSize: 16
        },
        //距左侧的距离
        left: 'center'
      },
      //工具提示
      tooltip: {
        formatter: '{b}:{c}例'
      },
      //视觉映射
      visualMap: [
        //分段类型
        {
          //分段类型
          type: 'piecewise',
          //自定义分段数据
          pieces: [
            { min: 0, max: 0 },
            { min: 1, max: 9 },
            { min: 10, max: 99 },
            { min: 100, max: 499 },
            { min: 500, max: 999 },
            { min: 1000, max: 999 },
            { min: 10000 }
          ],
          inRange: {
            color: ['#fff', '#fff4ef', '#ffe6da', '#fdb19b', '#e7856d', '#de512f', '#970a0f']
          }
        }
      ],
      //系列
      series: [
        {
          //地图
          type: 'map',
          //地图类型
          map: 'china',
          //图表文本
          label: {
            show: true,
            color: '#000'
          },
        },
      ],
      //调色盘
      color: ['#d48265', '#91c7ae', '#749f83', '#ca8622', '#bda29a', '#6e7074', '#546570']
    });
    //显示加载动画
    chart.showLoading();
    axios.get('http://127.0.0.1:3000/pdata').then(res=>{
      //接收服务器返回的数据并且天剑到图表中
      console.log(res.data.dataset)
      chart.setOption({
        series:[
          {
            //地图
            type:'map',
            map:'china',
            //从服务器返回的数据
            data:res.data.dataset
            
          }
        ]
      });
      //隐藏加载动画
      chart.hideLoading();
    })

  </script>
</body>

</html>